<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Untitled</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="GLM_tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="GLM_tutorial_files/libs/quarto-html/quarto.js"></script>
<script src="GLM_tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="GLM_tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GLM_tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="GLM_tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GLM_tutorial_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GLM_tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GLM_tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GLM_tutorial_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Untitled</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="part-1-building-on-linear-models-when-olms-fall-short" class="level1">
<h1>Part 1: Building on Linear Models: When OLMs Fall Short</h1>
<p>In the previous tutorial, we explored Ordinary Linear Models (OLMs) and learned that they dominate statistics because of their mathematical guarantees, computational efficiency, and interpretability. We also saw how linear models can handle complex relationships through transformations, polynomials, and interactions.</p>
<p>However, OLMs make several fundamental assumptions that simply don’t hold for many types of biological and genomic data:</p>
<ol type="1">
<li><p><strong>Continuous response variables</strong>: OLMs assume your outcome can take any real value</p></li>
<li><p><strong>Normal error distribution</strong>: Residuals should follow a normal distribution</p></li>
<li><p><strong>Constant variance</strong>: The spread of residuals should be the same across all fitted values</p></li>
<li><p><strong>Linear relationship</strong>: After transformations, the relationship should be linear in parameters</p></li>
</ol>
<p>But what happens when your data violates these assumptions in ways that can’t be fixed with transformations?</p>
<section id="when-biology-breaks-olm-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="when-biology-breaks-olm-assumptions">When Biology Breaks OLM Assumptions</h2>
<section id="count-data-the-rna-seq-problem" class="level3">
<h3 class="anchored" data-anchor-id="count-data-the-rna-seq-problem"><strong>Count Data: The RNA-seq Problem</strong></h3>
<p>Imagine you’re analyzing RNA-seq data, where you measure gene expression as integer values. (read counts).</p>
<p>Count data has several properties that break OLM assumptions:</p>
<ul>
<li><p><strong>Discrete, not continuous</strong>: You can’t have 2.5 reads</p></li>
<li><p><strong>Non-negative</strong>: Negative counts are impossible</p></li>
<li><p><strong>Variance increases with mean</strong>: RNA-seq count data is inhereintly heteroscedastic, with higher-expressed genes having greater variance among replicates than low-expressed genes. This varianbity comes from a combination of biological variation between cells, variance in library prep, and non-perfect read count normalization.</p></li>
<li><p><strong>Many zeros</strong>: Especially for lowly expressed genes</p></li>
</ul>
</section>
<section id="binary-outcomes-in-gwas-analysis" class="level3">
<h3 class="anchored" data-anchor-id="binary-outcomes-in-gwas-analysis">Binary outcomes in GWAS analysis</h3>
<p>In genome-wide association studies (GWAS), you have binary predictors (allele identity) but want to predict <strong>probabilities</strong>:</p>
<ul>
<li><p>Disease status → P(disease | genotype)</p></li>
<li><p>Treatment response → P(response | mutation_status)</p></li>
<li><p>Mutation presence → P(mutation | population_ancestry)</p></li>
</ul>
<p>The <strong>observed data</strong> is binary (0/1), but we want to <strong>predict probabilities</strong> (0 to 1). This violates OLM assumptions because:</p>
<ul>
<li><p><strong>Observed values are discrete</strong>: Only 0 or 1, not continuous</p></li>
<li><p><strong>Non-constant variance</strong>: Variance of binary outcomes is p(1-p), so it’s highest when probability ≈ 0.5 and lowest near 0 or 1</p></li>
<li><p><strong>Bounded predictions</strong>: We want probabilities between 0 and 1, but OLMs can predict any value (including negative “probabilities” or values &gt; 1)</p></li>
</ul>
</section>
<section id="survival-data-the-clinical-trial-problem" class="level3">
<h3 class="anchored" data-anchor-id="survival-data-the-clinical-trial-problem">Survival Data: The Clinical Trial Problem</h3>
<p>Survival analysis studies the time until an event occurs. Despite the name “survival,” the “event” doesn’t have to be death - it could be:</p>
<ul>
<li><p>Time until cancer recurrence</p></li>
<li><p>Time until treatment failure</p></li>
<li><p>Time until infection clearance</p></li>
</ul>
<p><strong>Example</strong>: In a cancer drug trial, you follow 100 patients for 5 years to see how long the treatment keeps their cancer in remission.</p>
<p>Survival data creates unique challenges:</p>
<ul>
<li><p><strong>Censoring</strong>: The study ends before some patients experience the event. Patient A is still cancer-free after 5 years - did the treatment “cure” them, or would they relapse in year 6? We don’t know.</p></li>
<li><p><strong>Bounded at zero:</strong> Survival times can’t be negative</p></li>
<li><p><strong>Time-varying risk</strong>: The risk of recurrence might change over time (high initially, then decrease, then increase again)</p></li>
<li><p><strong>Research questions</strong> - In survival analysis, you’re often interested in hazard rates (instantaneous risk of failure) rather than just predicting time-to-event, which requires specialized modeling. For example, you might want to know what is the risk that a pateints cancer returns in the next moment. This probabality will change over the course of time e.g.&nbsp;the hazard rate may initially be high after treatment (non-responders), then lower for a while as the treatment is effective, then higher again as the effects of the treatment wear off.</p></li>
</ul>
<p>This violates OLM assumptions because we have incomplete data (censoring) and we’re often more interested in modeling the instantaneous risk of failure at any given time, rather than just predicting the exact time to failure.</p>
</section>
</section>
</section>
<section id="part-2-enter-generalized-linear-models-glms" class="level1">
<h1>Part 2: Enter Generalized Linear Models (GLMs)</h1>
<p>GLMs extend linear models to handle the above scenarios by relaxing key assumptions while maintaining the linear model framework we are familiar with.</p>
<section id="the-glm-framework-three-components" class="level3">
<h3 class="anchored" data-anchor-id="the-glm-framework-three-components">The GLM Framework: Three Components</h3>
<p>Every GLM consists of three components:</p>
<ol type="1">
<li><strong>Outcome distribution family</strong> : Specifies the probability distribution of the response variable</li>
<li><strong>Systematic Component</strong>: The linear predictor (just like in OLMs): η = β₀ + β₁X₁ + β₂X₂ + …</li>
<li><strong>Link Function</strong>: Connects the expected value of Y to the linear predictor: g(μ) = η. In other words, it transforms the continuous output of the linear predictors to conform to the outcome distribution family.</li>
</ol>
<p>It might seem that the link function and the outcome distribution family are really two sides of the same component, since the link function essentially defines the outcome distribution. This is not incorrect, however there are instances beyond the scope of this tutorial where it can be valuable to think of them as separate components. For example, you can have multiple different link functions that each transform data that conforms to the same outcome distribution.</p>
<p>In practice however, each outcome distribution family is frequently associated with a specific link function:</p>
<ul>
<li><p>Binomial → logit link (99% of the time)</p></li>
<li><p>Poisson → log link (99% of the time)</p></li>
<li><p>Negative Binomial → log link (99% of the time)</p></li>
<li><p>Normal → identity link (always - this just means the expected value of the outcome equals the linear predictor directly. This is what OLMs use and is the easiest to interpret)</p></li>
<li><p>Gamma → log link (most common, ~80% of the time)</p></li>
</ul>
<p>You may wonder, how can the same link function (e.g.&nbsp;the log link) be associated with different outcome distributions? The reason is that the linear predictor and the link only predict the expected mean value. However the outcome distribution determines the shape of the expected variance around that mean.</p>
<p>When a GLM is fit, it will estimate the regression coefficients (β₀, β₁, etc.) that determine the mean, plus any additional distribution specific parameters that control the variance structure. For example:</p>
<p><strong>Poission outcome:</strong> No additional parameters needed, since mean = variance by definition.</p>
<p><strong>Negative Binomial outcome:</strong> Estimates a dispersion parameter θ (theta) that controls overdispersion. Variance = mean + (mean²/θ), allowing for much more variability than Poisson.</p>
<p><strong>Gamma outcome:</strong> Estimates a shape parameter that controls the variance-to-mean relationship. Variance = mean²/shape, so variance increases with the square of the mean.</p>
<p><strong>Normal outcome:</strong> Estimates σ² (error variance), which is constant regardless of the mean value.</p>
</section>
<section id="key-insight-glms-transform-the-mean-not-the-data" class="level3">
<h3 class="anchored" data-anchor-id="key-insight-glms-transform-the-mean-not-the-data">Key Insight: GLMs Transform the Mean, Not the Data</h3>
<p>In OLMs, we sometimes transform the response variable (e.g., log(Y)) to meet assumptions. In GLMs, we transform the <strong>expected value</strong> of Y using a link function, while keeping the original data intact.</p>
<p>This is powerful because we maintain the original scale and interpretation of our data while allowing for predicted expected values that follow a specific distribution (e.g.&nbsp;predicting the expecgted probability of disease using data that only contains binary outcomes)</p>
</section>
</section>
<section id="part-3-tutorial-with-tcga-breast-cancer-data" class="level1">
<h1>Part 3: Tutorial with TCGA Breast Cancer data</h1>
<section id="introduction-our-research-goals" class="level2">
<h2 class="anchored" data-anchor-id="introduction-our-research-goals">Introduction: Our Research Goals</h2>
<p>You’re a cancer genomics researcher analyzing The Cancer Genome Atlas (TCGA) breast cancer cohort. Your team wants to understand how genomic alterations drive cancer progression and treatment response. Specifically, you need to determine:</p>
<ol type="1">
<li><p><strong>CNV Associations</strong>: Which copy number variations are associated with aggressive disease?</p></li>
<li><p><strong>Expression-Outcome Links</strong>: Does the expression level of key cancer genes predict survival outcomes?</p></li>
<li><p><strong>Integrated Analysis</strong>: How do CNVs affect gene expression, and how does this impact patient outcomes?</p></li>
<li><p><strong>Clinical Prediction</strong>: Can we build genomic signatures for treatment stratification?</p></li>
<li><p><strong>High-dimensional Modeling</strong>: With thousands of genes, how do we avoid overfitting?</p></li>
<li><p>This analysis will use <strong>real genomic data</strong> from over 1,000 breast cancer patients, demonstrating GLM applications in cancer genomics research.</p></li>
</ol>
</section>
<section id="why-glms-are-essential-for-cancer-genomics" class="level2">
<h2 class="anchored" data-anchor-id="why-glms-are-essential-for-cancer-genomics">Why GLMs Are Essential for Cancer Genomics</h2>
<p>Cancer genomics data presents unique challenges that can be addressed by GLMs as well as regularization:</p>
<ol type="1">
<li><p><strong>Copy Number Data</strong>: Discrete integer values or categorical values (-2, -1, 0, +1, +2) representing deletions/amplifications. The same as true for SNPs.<br>
</p></li>
<li><p><strong>Binary Clinical Outcomes</strong>: Survival status, treatment response, molecular subtypes<br>
</p></li>
<li><p><strong>High-dimensional Data with many variables and relativley few outcomes</strong>: Thousands of genes but hundreds of patients. Requires regularization to prevent model overfitting.<br>
</p></li>
<li><p><strong>Non-linear Relationships</strong>: Gene dosage effects, interaction between CNVs and expression<br>
</p></li>
</ol>
<section id="load-required-libraries-and-real-tcga-data" class="level3">
<h3 class="anchored" data-anchor-id="load-required-libraries-and-real-tcga-data">Load Required Libraries and Real TCGA Data</h3>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<p><strong>Load necessary libraries</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(curatedTCGAData) <span class="co"># for access to TCGA</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidySummarizedExperiment) <span class="co"># containers for genomic data: stores expression/CNV metadata</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MultiAssayExperiment) <span class="co"># integrates multiple data types (expression + CNV + clinical)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># for tidy output of linear models</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC) <span class="co"># Calculates AUC, plos ROC curves for model analysis</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival) <span class="co"># statistics for survivial analysis</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer) <span class="co"># for making pretty survival plots</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)        <span class="co"># For regularization (Ridge, Lasso, Elastic Net)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># for making correlation matrix plots</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot) <span class="co"># ggplot style correlation plots</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># for regex </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Download the curated breast cancer data from TCGA</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the Multi Assay Experiment associated with the BRCA object </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This will download normalized RNA-seq expression data, and clinical data from the BRXA dataset  </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>brca_mae <span class="ot">&lt;-</span> <span class="fu">curatedTCGAData</span>(<span class="st">"BRCA"</span>, <span class="at">assays =</span> <span class="fu">c</span>(<span class="st">"RNASeq2GeneNorm"</span>, <span class="st">"clinical"</span>), </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">version =</span> <span class="st">"2.1.1"</span>, <span class="at">dry.run =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print experiment names</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dataset succesfully downloaded</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The names of the experiments are:"</span>, <span class="fu">names</span>(brca_mae), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This downloads an S4 class object. S4 objects have:</p>
<ol type="1">
<li>Slots - named components that hold specific types of data</li>
<li>Classes - Blueprints that define which slots exist and what data types they can hold</li>
<li>Methods - Functions that work with specific S4 classes</li>
</ol>
<p>This specific S4 object is of a MultiAssayExperiment class – a class designed specifically for multi-omics data. The key slots in a this type of class are:</p>
<p>The experiments slot contains different data types, e.g.&nbsp;RNASeq2GeneNorm, etc.: brca_mae@ExperimentList</p>
<p>The colData slot has patient demographic and clinical information: brca_mae@colData</p>
<p>The sampleMap links samples across experiments by showing which samples belong to which patient: brca_mae@sampleMap</p>
<p><strong>Extract the RNA-seq data and patient metadata from brca_mae</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'assay' is a method that extracts the data matrix from summarizedExperiment objects  </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>expression_data <span class="ot">&lt;-</span> <span class="fu">assay</span>(brca_mae[[<span class="st">"BRCA_RNASeq2GeneNorm-20160128"</span>]])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"expression_data is a"</span>, <span class="fu">dim</span>(expression_data)[<span class="dv">1</span>], <span class="st">"by"</span>, <span class="fu">dim</span>(expression_data)[<span class="dv">2</span>],</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">class</span>(expression_data)[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>expression_data is a 18300 by 1212 matrix </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Columns are patients IDs and rows are gene names</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns are patients IDs and rows are gene names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In Bioconductor Objects, clinical data is accessed with colData</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">colData</span>(brca_mae)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"clinical_data is a"</span>, <span class="fu">dim</span>(clinical_data)[<span class="dv">1</span>], <span class="st">"by"</span>, <span class="fu">dim</span>(clinical_data)[<span class="dv">2</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">class</span>(clinical_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>clinical_data is a 1093 by 2684 DFrame </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows are patients IDs and each row contains a list with metadata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows are patients IDs and each row contains a list with metadata</code></pre>
</div>
</div>
<p><strong>Subset the data to include only patients in both the RNA-seq and clinical metadata objects</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>expression_patients <span class="ot">&lt;-</span> <span class="fu">colnames</span>(expression_data)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use regular expression -- stringer package -- to get the short ID that matches the metadata</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>expression_patients_succinct <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(expression_patients, <span class="st">"TCGA-[A-Z0-9]{2}-[A-Z0-9]{4}"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(expression_data) <span class="ot">&lt;-</span> expression_patients_succinct</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>clinical_patients <span class="ot">&lt;-</span> <span class="fu">rownames</span>(clinical_data)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>common_patients <span class="ot">&lt;-</span> <span class="fu">intersect</span>(clinical_patients, expression_patients_succinct)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"There are"</span>, <span class="fu">length</span>(common_patients), <span class="st">"common patients across the RNA-seq data and clinical metadata</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 1093 common patients across the RNA-seq data and clinical metadata</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the expression data and clinical data in place</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>expression_data <span class="ot">&lt;-</span> expression_data[, common_patients]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> clinical_data[common_patients,]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"expression_data is now a"</span>, <span class="fu">class</span>(expression_data), <span class="st">"with"</span>, <span class="fu">nrow</span>(expression_data), <span class="st">"rows and"</span>, <span class="fu">ncol</span>(expression_data), <span class="st">"columns</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>expression_data is now a matrix array with 18300 rows and 1093 columns</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"clinical_data is now a"</span>, <span class="fu">class</span>(clinical_data), <span class="st">"with"</span>, <span class="fu">nrow</span>(clinical_data), <span class="st">"rows and"</span>, <span class="fu">ncol</span>(clinical_data), <span class="st">"columns</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>clinical_data is now a DFrame with 1093 rows and 2684 columns</code></pre>
</div>
</div>
<p>Our analysis will now focus on known key cancer genes with established roles in breast cancer.</p>
<p><strong>Define key genes and extract expression data for them</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cancer_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ERBB2"</span>, <span class="st">"MYC"</span>, <span class="st">"CCND1"</span>, <span class="st">"PIK3CA"</span>,    <span class="co"># Oncogenes</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"TP53"</span>, <span class="st">"BRCA1"</span>, <span class="st">"PTEN"</span>, <span class="st">"RB1"</span>,        <span class="co"># Tumor suppressors  </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ESR1"</span>, <span class="st">"PGR"</span>, <span class="st">"AR"</span>,                   <span class="co"># Hormone receptors</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"CDK1"</span>, <span class="st">"CDKN2A"</span>, <span class="st">"AURKA"</span>)             <span class="co"># Cell cycle genes</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>expr_subset <span class="ot">&lt;-</span> expression_data[cancer_genes,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Create a dataframe that holds clinical data of interest to this analysis and key gene expression levels for each patient</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> common_patients,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># deomgraphic info</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">as.numeric</span>(clinical_data<span class="sc">$</span>patient.age_at_initial_pathologic_diagnosis),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vital_status =</span> <span class="fu">ifelse</span>(clinical_data<span class="sc">$</span>patient.vital_status <span class="sc">==</span> <span class="st">"dead"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="co"># alive or dead</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_to_death  =</span> <span class="fu">as.numeric</span>(clinical_data<span class="sc">$</span>patient.days_to_death), <span class="co"># days from diagnosis to death</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">days_to_last_followup =</span> <span class="fu">as.numeric</span>(clinical_data<span class="sc">$</span>patient.days_to_last_followup), <span class="co"># days from diagnosis to last contact</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tumor characteristics</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stage =</span> clinical_data<span class="sc">$</span>pathologic_stage,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">er_status =</span> clinical_data<span class="sc">$</span>patient.breast_carcinoma_estrogen_receptor_status, <span class="co"># do the cells have estrogen receptors</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">pr_status =</span> clinical_data<span class="sc">$</span>patient.breast_carcinoma_estrogen_receptor_status, <span class="co"># do the cells have progesterone receptors</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gene expression data</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">erbb2_expr =</span> expr_subset[<span class="st">"ERBB2"</span>, ],</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">tp53_expr =</span> expr_subset[<span class="st">"TP53"</span>, ],</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">brca1_expr =</span> expr_subset[<span class="st">"BRCA1"</span>, ],</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">myc_expr =</span> expr_subset[<span class="st">"MYC"</span>, ],</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">esr1_expr =</span> expr_subset[<span class="st">"ESR1"</span>, ],</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">pgr_expr =</span> expr_subset[<span class="st">"PGR"</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>